{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../util.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@ionic/angular\";\nfunction ViewNewsPage_ion_card_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\")(1, \"ion-card-header\")(2, \"ion-card-title\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"ion-card-content\");\n    i0.ɵɵelement(5, \"img\", 7);\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const news_r2 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(news_r2.post_title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", news_r2.featured_image, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Description:\", news_r2.post_content, \"\");\n  }\n}\nfunction ViewNewsPage_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\");\n    i0.ɵɵtext(2, \"No news available.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let ViewNewsPage = /*#__PURE__*/(() => {\n  class ViewNewsPage {\n    constructor(util, router) {\n      this.util = util;\n      this.router = router;\n      this.loginUser = [];\n      this.loadData = false;\n      this.newsData = [];\n      this.page = 1;\n      this.hasMoreData = true;\n    }\n    ionViewWillEnter() {\n      this.getLoginUser();\n      this.getNewsData();\n    }\n    getLoginUser() {\n      const user = JSON.parse(localStorage.getItem('login'));\n      if (user !== null) {\n        this.loginUser = user;\n      }\n    }\n    getNewsData(event) {\n      if (this.loginUser && this.loginUser.token) {\n        this.loadData = true;\n        const token = this.loginUser.token;\n        const paged = {\n          paged: this.page\n        };\n        this.util.sendData('getNewsFeed', paged, token).subscribe({\n          next: p => {\n            if (p.status == 'success') {\n              const newNews = p.data;\n              this.newsData = [...this.newsData, ...newNews];\n              this.loadData = false;\n              // Check if more data is available\n              if (newNews.length < 6) {\n                this.hasMoreData = false;\n              }\n            } else {\n              console.error('Failed to fetch newsfeed data');\n              this.loadData = false;\n            }\n          },\n          error: err => {\n            console.error('Error fetching newsfeed data:', err);\n          },\n          complete: () => {\n            if (event) {\n              event.target.complete(); // Complete infinite scroll event\n            }\n          }\n        });\n      } else {\n        console.error('User token not available');\n      }\n    }\n    loadMoreNews(event) {\n      if (this.hasMoreData) {\n        this.page++;\n        this.getNewsData(event); // Fetch next set of data\n      } else {\n        event.target.disabled = true;\n      }\n    }\n    static #_ = (() => this.ɵfac = function ViewNewsPage_Factory(t) {\n      return new (t || ViewNewsPage)(i0.ɵɵdirectiveInject(i1.UtilService), i0.ɵɵdirectiveInject(i2.Router));\n    })();\n    static #_2 = (() => this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ViewNewsPage,\n      selectors: [[\"app-view-news\"]],\n      decls: 11,\n      vars: 3,\n      consts: [[\"noData\", \"\"], [3, \"translucent\"], [\"name\", \"arrow-back-outline\", \"routerLink\", \"/news\", \"routerDirection\", \"back\"], [3, \"fullscreen\"], [4, \"ngFor\", \"ngForOf\"], [\"threshold\", \"100px\", 3, \"ionInfinite\"], [\"loadingSpinner\", \"bubbles\", \"loadingText\", \"Loading more news...\"], [\"alt\", \"News Image\", 3, \"src\"]],\n      template: function ViewNewsPage_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"ion-header\", 1)(1, \"ion-toolbar\");\n          i0.ɵɵelement(2, \"ion-icon\", 2);\n          i0.ɵɵelementStart(3, \"ion-title\");\n          i0.ɵɵtext(4, \"View News\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(5, \"ion-content\", 3);\n          i0.ɵɵtemplate(6, ViewNewsPage_ion_card_6_Template, 8, 3, \"ion-card\", 4);\n          i0.ɵɵelementStart(7, \"ion-infinite-scroll\", 5);\n          i0.ɵɵlistener(\"ionInfinite\", function ViewNewsPage_Template_ion_infinite_scroll_ionInfinite_7_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.loadMoreNews($event));\n          });\n          i0.ɵɵelement(8, \"ion-infinite-scroll-content\", 6);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(9, ViewNewsPage_ng_template_9_Template, 3, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"translucent\", true);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"fullscreen\", true);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngForOf\", ctx.newsData);\n        }\n      },\n      dependencies: [i3.NgForOf, i4.IonCard, i4.IonCardContent, i4.IonCardHeader, i4.IonCardTitle, i4.IonContent, i4.IonHeader, i4.IonIcon, i4.IonInfiniteScroll, i4.IonInfiniteScrollContent, i4.IonItem, i4.IonLabel, i4.IonTitle, i4.IonToolbar, i4.RouterLinkDelegate, i2.RouterLink]\n    }))();\n  }\n  return ViewNewsPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}